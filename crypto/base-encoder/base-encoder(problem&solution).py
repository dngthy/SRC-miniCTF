from secret import FLAG
base = {"110000": "w",
        "110001": "x",
        "110101": "1",
        "110100": "0",
        "010100": "U",
        "010101": "V",
        "001100": "M",
        "001101": "N",
        "011110": "e",
        "011111": "f",
        "001001": "J",
        "001000": "I",
        "011011": "b",
        "011010": "a",
        "000110": "G",
        "000111": "H",
        "000011": "D",
        "000010": "C",
        "100100": "k",
        "100101": "l",
        "111100": "8",
        "111101": "9",
        "100010": "i",
        "100011": "j",
        "101110": "u",
        "101111": "v",
        "111001": "5",
        "111000": "4",
        "101011": "r",
        "101010": "q",
        "110011": "z",
        "110010": "y",
        "010010": "S",
        "010011": "T",
        "010111": "X",
        "010110": "W",
        "110110": "2",
        "110111": "3",
        "011000": "Y",
        "011001": "Z",
        "001111": "P",
        "001110": "O",
        "011101": "d",
        "011100": "c",
        "001010": "K",
        "001011": "L",
        "101101": "t",
        "000000": "A",
        "000001": "B",
        "100111": "n",
        "100110": "m",
        "000101": "F",
        "000100": "E",
        "111111": "/",
        "111110": "+",
        "100001": "h",
        "100000": "g",
        "010001": "R",
        "010000": "Q",
        "101100": "s",
        "111010": "6",
        "111011": "7",
        "101000": "o",
        "101001": "p"}

base_convert = {"w": "110000",
        "x": "110001",
        "1": "110101",
        "0": "110100",
        "U": "010100",
        "V": "010101",
        "M": "001100",
        "N": "001101",
        "e": "011110",
        "f": "011111",
        "J": "001001",
        "I": "001000",
        "b": "011011",
        "a": "011010",
        "G": "000110",
        "H": "000111",
        "D": "000011",
        "C": "000010",
        "k": "100100",
        "l": "100101",
        "8": "111100",
        "9": "111101",
        "i": "100010",
        "j": "100011",
        "u": "101110",
        "v": "101111",
        "5": "111001",
        "4": "111000",
        "r": "101011",
        "q": "101010",
        "z": "110011",
        "y": "110010",
        "S": "010010",
        "T": "010011",
        "X": "010111",
        "W": "010110",
        "2": "110110",
        "3": "110111",
        "Y": "011000",
        "Z": "011001",
        "P": "001111",
        "O": "001110",
        "d": "011101",
        "c": "011100",
        "K": "001010",
        "L": "001011",
        "t": "101101",
        "A": "000000",
        "B": "000001",
        "n": "100111",
        "m": "100110",
        "F": "000101",
        "E": "000100",
        "/": "111111",
        "+": "111110",
        "h": "100001",
        "g": "100000",
        "R": "010001",
        "Q": "010000",
        "s": "101100",
        "6": "111010",
        "7": "111011",
        "o": "101000",
        "p": "101001"}

def encode(string):
    s = ""
    for i in string:
        s += bin(ord(i))[2:].zfill(8)

    pad = ""
    if len(s) % 6 == 4:
        pad = "="
        s += "11"
    elif len(s) % 6 == 2:
        pad = "=="
        s += "1111"

    ret = ""
    for i in range(0, len(s), 6):
        ret += base[s[i:i+6]]
    return ret[::-1]+pad

def decode(string):
    flag = "3HM0BXWSN0XtBDdzV3YfNTbwM3eDJ1U"[::-1] # remove last "="
    f_bin = ""
    for i in flag:
        f_bin += base_convert[i]
    # remove last "11" from f_bin, we have the following value
    f_bin="0101001101010010010000110111101101110011001100000110110100110011010111110110001101110101011100110111010000110000011011010101111101000011010100100101100101110000011101000011000001111101"
    s=""
    for i in range(0,len(f_bin), 8): 
        s+=(chr(int(f_bin[i:i+8],2)))
    return s;
print(decode(FLAG)) #SRC{s0m3_cust0m_CRYpt0}

# 3HM0BXWSN0XtBDdzV3YfNTbwM3eDJ1U=
